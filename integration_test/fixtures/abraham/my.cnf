

[client]
port                            = 3306
socket                          = /var/vcap/sys/run/pxc-mysql/mysqld.sock

# !include                        /var/vcap/jobs/pxc-mysql/config/auto-tune.cnf 

[mysqld]
server-id                       = 0
#ssl-ca=/var/vcap/jobs/pxc-mysql/certificates/server-ca.pem
#ssl-cert=/var/vcap/jobs/pxc-mysql/certificates/server-cert.pem
#ssl-key=/var/vcap/jobs/pxc-mysql/certificates/server-key.pem


# GALERA options:
pxc-strict-mode                 = MASTER
wsrep_on                        = ON
wsrep_provider                  = /var/vcap/packages/libgalera/lib/libgalera_smm.so
wsrep_provider_options          = "gcache.size=512M;pc.recovery=FALSE;pc.checksum=TRUE"
wsrep_cluster_address           = gcomm://ce32e5cb-165f-481d-810f-e11ecd1e2956.database.default.cf.bosh,acefa7bd-1293-4082-9fff-1214f846ab00.database.default.cf.bosh,127.0.0.1:3006
wsrep_node_address              = 127.0.0.1:3306
wsrep_node_name                 = database/0
wsrep_cluster_name              = galera-cluster
wsrep_sst_method                = xtrabackup-v2
wsrep_sst_auth                  = root:root
wsrep_max_ws_rows               = 0
wsrep_max_ws_size               = 1073741824
wsrep_load_data_splitting       = ON
wsrep_replicate_myisam          = OFF
wsrep_debug                     = OFF
wsrep_log_conflicts             = ON


# Regular MYSQL options:
character_set_server            = utf8
collation_server                = utf8_unicode_ci
user                            = vcap
socket                          = /var/vcap/sys/run/pxc-mysql/mysqld.sock
port                            = 13306
basedir                         = /var/vcap/packages/pxc
datadir                         = /var/vcap/store/pxc-mysql
tmpdir                          = /var/vcap/data/pxc-mysql/tmp
language                        = /var/vcap/packages/pxc/share
pid-file                        = /var/vcap/sys/run/pxc-mysql/mysql.pid
log_error                       = /var/vcap/sys/log/pxc-mysql/mysql.err.log
init_file                       = /var/vcap/jobs/pxc-mysql/config/db_init
skip_external_locking           = TRUE
symbolic-links                  = OFF
secure_file_priv                = /var/vcap/data/pxc-mysql/files
table_definition_cache          = 8192
table_open_cache                = 2000

max_allowed_packet              = 256M
skip_name_resolve               = ON

sql-mode                        = NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION,STRICT_ALL_TABLES

local_infile                    = ON



# Required for user to create triggers when binlog is enabled
log_bin_trust_function_creators = 1

# Slow query logging:
slow_query_log                  = 1
slow_query_log_file             = /var/vcap/sys/log/pxc-mysql/mysql_slow_query.log
long_query_time                 = 10
log_queries_not_using_indexes   = OFF

# User statistics
userstat                        = OFF

innodb_file_per_table           = ON
innodb_file_format              = Barracuda
innodb_log_file_size            = 1024MB
innodb_support_xa               = OFF
innodb_large_prefix             = ON
innodb_strict_mode              = OFF

max_heap_table_size             = 16777216
tmp_table_size                  = 33554432

# These are mandatory MySQL settings for Galera to work
binlog_format                   = ROW
default_storage_engine          = InnoDB
innodb_autoinc_lock_mode        = 2
innodb_doublewrite              = 1
query_cache_size                = 0
query_cache_type                = OFF

# These are required to make the quota enforcer work
innodb_stats_on_metadata        = ON
innodb_stats_persistent         = OFF

innodb_flush_log_at_trx_commit  = 1

innodb_lock_wait_timeout        = 50

#innodb_flush_method             = fsync

innodb_log_buffer_size          = 32M

max_connections                 = 1500

# Event Scheduler
event_scheduler                 = OFF



#[sst]
#encrypt=4
#ssl-ca=/var/vcap/jobs/pxc-mysql/certificates/galera-ca.pem
#ssl-cert=/var/vcap/jobs/pxc-mysql/certificates/galera-cert.pem
#ssl-key=/var/vcap/jobs/pxc-mysql/certificates/galera-key.pem

[mysqldump]
quick
max_allowed_packet              = 256M

[mysql]
max_allowed_packet              = 256M
